#!/usr/bin/env python3

import os
import json

# Print the sha1 value of the file that is not considered safe, in this case it will be deleted.

def analyze():
    file_path = os.path.expanduser("~/Desktop/Thesis/Malware-Early-Detection/VT_Reports.json")

    with open(file_path, 'r') as file:
        json_text = file.read()

        data = json.loads(json_text)


    for object in data:
        stats = (object['data']['attributes']['stats'])
        if is_sus_greater(stats):
            print(object['meta']['file_info']['sha1'])


# Returns true if the value of suspicious activities detected are 5% more than safe activities detected.

def is_sus_greater(stats):
    threshold_percentage = 5
    safe_value = stats.get('undetected', 0) + stats.get('harmless', 0)
    sus_value = stats.get('suspicious', 0) + stats.get('malicious', 0)
    return sus_value > (threshold_percentage / 100) * safe_value

if __name__ == "__main__":
    analyze()